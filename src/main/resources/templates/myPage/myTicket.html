<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/defaultLayout}">
<head>
    <title>QuickTicket - 예매 상세정보</title>
    <link rel="stylesheet" th:href="@{/css/common.css}">
    <link rel="stylesheet" th:href="@{/css/myPage.css}">
</head>
<body>
    <main layout:fragment="content">
        <div class="page-wrapper">
            <div class="main-container">

                <h2 class="page-title" style="border-bottom:none;">예매 상세정보</h2>

                <!-- 공연정보 영역 -->
                <section class="detail-layout top-section">
                    <div class="poster-area">
                        <img th:src="@{/images/concertImage5.png}" alt="concert5">
                    </div>

                    <div class="info-area">
                        <h3 class="sub-title">공연 정보</h3>

                        <div class="gray-box">
                            <div class="info-row">
                                <span class="label">공연명</span>
                                <span class="value">엔드 앤드</span>
                            </div>
                            <div class="info-row">
                                <span class="label">공연일자</span>
                                <span class="value">2026-01-01 / 오후 12:00</span>
                            </div>
                            <div class="info-row">
                                <span class="label">회차</span>
                                <span class="value">1회차</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 선택된좌석 정보 영역 -->
                <section class="detail-layout seat-section">
                    <div class="map-view-area">
                        <div class="seat-map-area">
                            <div>
                                <p>좌석선택영역입니다.</p>
                            </div>
                        </div>
                        <!-- 범례영역 -->
                        <div class="map-legend">
                            <span class="legend-item"><span class="color-box confirmed"></span> 예매 확정된 좌석</span>
                            <span class="legend-item"><span class="color-box pending"></span> 예매 대기중인 좌석</span>
                        </div>
                    </div>

                    <div class="seat-info-area">
                        <h3 class="sub-title">좌석 선택 / 결제</h3>

                        <div class="gray-box mb-20">
                            <div class="info-row">
                                <span class="label">희망 좌석</span>
                                <span class="value">12석 중 2석 (S석 10개, VIP석 2개)</span>
                            </div>
                            <div class="info-row">
                                <span class="label">좌석 예매 상태</span>
                                <span class="value text-blue">전체 확정</span>
                            </div>
                            <div class="info-row">
                                <span class="label">결제된 좌석</span>
                                <span class="value">2석 (S석 1개, VIP석 1개)</span>
                            </div>
                            <div class="info-row">
                                <span class="label">좌석별 가격</span>
                                <span class="value">
                                    VIP석: 10,000원<br>
                                    S석: 5,000원
                                </span>
                            </div>
                        </div>

                        <h3 class="sub-title">예매 확정 좌석</h3>
                        <div class="confirmed-seat-list">
                            <div class="seat-item-row">
                                <span class="seat-loc">A구역 R24</span>
                                <span class="seat-price">VIP석 <span class="price">10,000원</span></span>
                            </div>
                            <div class="seat-item-row">
                                <span class="seat-loc">A구역 R25</span>
                                <span class="seat-price">VIP석 <span class="price">10,000원</span></span>
                            </div>
                        </div>
                    </div>
                </section>
                <!-- 예매정보 영역-->
                <section class="detail-row">
                    <h3 class="sub-title">예매 정보</h3>
                    <div class="gray-box">
                        <div class="info-row">
                            <span class="label">예매번호</span>
                            <span class="value">RES-2026-001</span>
                        </div>
                        <div class="info-row">
                            <span class="label">예매일자</span>
                            <span class="value">2026-01-01 / 12:00:00</span>
                        </div>
                        <div class="info-row">
                            <span class="label">결제 예상 범위</span>
                            <span class="value">
                                20,000원 ~ 10,000원<br>
                                <span class="sub-text">※ 취소표 발생 시 가장 먼저 매칭된 좌석의 금액으로 자동 결제됩니다.</span>
                            </span>
                        </div>
                    </div>
                </section>
                <!-- 결제정보 영역-->
                <section class="detail-row">
                    <h3 class="sub-title">결제 정보</h3>
                    <div class="gray-box">
                        <div class="info-row">
                            <span class="label">결제수단</span>
                            <span class="value">크레딧</span>
                        </div>
                        <div class="info-row">
                            <span class="label">결제 상태</span>
                            <span class="value text-bold">전체 결제 완료</span>
                        </div>
                        <div class="info-row">
                            <span class="label">결제금액</span>
                            <span class="value text-bold">15,000원</span>
                        </div>
                    </div>
                </section>

                <!-- 버튼 영역 -->
                <div class="form-footer-buttons">
                    <button class="btn-submit" style="width: 110px;" onclick="openReviewModal()">감상평 등록</button>
                    <a th:href="@{/cancelTicketSuccess}" class="btn-list" style="width: 110px;">등록취소</a>
                </div>
            </div>
        </div>

        <div th:replace="~{reviewPopup :: reviewModal}"></div>

        <script>
            // 리뷰 모달 열기
            function openReviewModal() {
                const modal = document.getElementById('reviewModal');
                if(modal) {
                    modal.classList.remove('hidden');
                }
            }

            // 리뷰 모달 닫기
            function closeReviewModal() {
                const modal = document.getElementById('reviewModal');
                if(modal) {
                    modal.classList.add('hidden');
                }
            }

            // 별점 기능
            function setRating(score) {
                const stars = document.querySelectorAll('#starContainer .star');
                document.getElementById('reviewRating').value = score;

                stars.forEach((star, index) => {
                    // 인덱스는 0부터 시작하므로 index < score 비교
                    if (index < score) {
                        // 채워진 별
                        star.classList.remove('fa-regular');
                        star.classList.add('fa-solid');
                        star.style.color = '#333';
                    } else {
                        // 빈 별
                        star.classList.remove('fa-solid');
                        star.classList.add('fa-regular');
                        star.style.color = '#ddd';
                    }
                });
            }

            // 배경 클릭 시 닫기
            document.addEventListener('DOMContentLoaded', function() {
                const modal = document.getElementById('reviewModal');
                if (modal) {
                    modal.addEventListener('click', function(event) {
                        if (event.target === this) {
                            closeReviewModal();
                        }
                    });
                }
            });
        </script>
    </main>

</body>
</html>