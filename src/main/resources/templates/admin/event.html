<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/defaultLayout}">
<head>
    <title>QuickTicket - 콘서트 관리</title>
    <link rel="stylesheet" th:href="@{/css/common.css}">
    <link rel="stylesheet" th:href="@{/css/admin.css}">
</head>
<body>

<main layout:fragment="content">
    <div class="page-wrapper">
        <div class="main-container">
            <form class="search-filter-box">
                <div class="filter-group">
                    <span class="filter-label">공연기간</span>
                    <div style="position: relative;">
                        <input type="text" class="form-input date-wrapper" value="2026.01.01 ~ 2026.01.31">
                        <i class="fa-regular fa-calendar" style="position: absolute; right: 10px; top: 12px; color: #999;"></i>
                    </div>
                </div>

                <div class="filter-group">
                    <span class="filter-label">카테고리</span>
                    <select class="form-select custom-select">
                        <option value="">전체</option>
                        <option value="KPOP">KPOP</option>
                        <option value="CLASSIC">CLASSIC</option>
                    </select>
                </div>

                <div class="filter-group">
                    <span class="filter-label">상태</span>
                    <select class="form-select custom-select">
                        <option value="">전체</option>
                        <option value="SALE">판매중</option>
                        <option value="SOLD_OUT">매진</option>
                    </select>
                </div>

                <div class="filter-group">
                    <input type="text" class="form-input keyword-input" placeholder="Value">
                </div>

                <button type="button" class="btn-search">검색</button>
            </form>
            <div class="list-header">
                <div class="sub-title">콘서트 목록</div>
                <a th:href="@{/newEvent}" class="btn-register">신규 콘서트 등록</a>
            </div>

            <div class="table-container">
                <table class="common-table">
                    <thead>
                        <tr>
                            <th class="col-check" style="text-align: center">
                                <input type="checkbox">
                            </th>
                            <th class="col-no">NO</th>
                            <th class="col-thumb">썸네일</th>
                            <th>카테고리</th>
                            <th>공연명</th>
                            <th>출연자</th>
                            <th>공연장소</th>
                            <th>상태</th>
                            <th class="col-action"></th>
                        </tr>
                    </thead>
                    <tbody id="eventListContainer">
                        <tr th:each="event, stat : ${eventList}" th:id="'event-row-' + ${stat.count}">
                            <td style="text-align: center;">
                                <input type="checkbox">
                            </td>
                            <td th:text="${stat.count}">1</td>
                            <td>
                                <div class="thumb-box">
                                    <img th:if="${event?.thumbnailImage != null}"
                                         th:src="@{/display(fileName=${event?.name})}"
                                         style="width: 100%; height: 100%; object-fit: cover;">
                                </div>
                            </td>
                            <td>
                                [[${event?.category1Name ?: ''}]]
                                [[${event?.category2Name != null ? ' > ' + event.category2Name : ''}]]
                            </td>
                            <td>
                                <a th:href="@{/editEvent/{id}(id=${event?.name ?: ''})}" class="link-title">
                                    [[${event?.name ?: '-'}]]
                                </a>
                            </td>
                            <td>[[${event?.cast ?: '-'}]]</td>
                            <td>[[${event?.description ?: '장소 미정'}]]</td>
                            <td>
                                <span class="status-tag">
                                    [[${event?.ageRating?.description ?: '미지정'}]]
                                </span>
                            </td>
                            <td style="text-align: center; cursor: pointer; color: #999;">
                                <i class="fa-solid fa-ellipsis-vertical"></i>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="pagination">
                <a href="#" class="page-btn"><i class="fa-solid fa-angles-left"></i></a>
                <a href="#" class="page-btn"><i class="fa-solid fa-angle-left"></i></a>
                <a href="#" class="page-btn active">1</a>
                <a href="#" class="page-btn">2</a>
                <a href="#" class="page-btn">3</a>
                <a href="#" class="page-btn"><i class="fa-solid fa-angle-right"></i></a>
                <a href="#" class="page-btn"><i class="fa-solid fa-angles-right"></i></a>
            </div>

        </div>
    </div>
    <script th:inline="javascript">
        document.addEventListener('DOMContentLoaded', function() {
            const eventListContainer = document.getElementById('eventListContainer');

            // 데이터가 없으면
            if (eventListContainer.children.length === 0) {
                // 임시데이터
                const tempEvents = [
                    {
                        no: 1,
                        category: "CONCERT > KPOP",
                        name: "2026 이창섭 단독 콘서트 〈EndAnd〉 - 수원",
                        cast: "이창섭",
                        location: "수원 실내체육관",
                        age: "전체 관람가"
                    },
                    {
                        no: 2,
                        category: "CONCERT > TROT",
                        name: "2026 임영웅 아임 히어로 콘서트",
                        cast: "임영웅",
                        location: "서울 월드컵경기장",
                        age: "전체 관람가"
                    },
                    {
                        no: 3,
                        category: "CLASSIC > OPERA",
                        name: "라 트라비아타",
                        cast: "조수미 외",
                        location: "예술의 전당",
                        age: "만 7세 이상"
                    }
                ];

                tempEvents.forEach(event => {
                    const row = `
                    <tr id="event-row-${event.no}">
                        <td style="text-align: center;"><input type="checkbox"></td>
                        <td>${event.no}</td>
                        <td><div class="thumb-box"></div></td>
                        <td>${event.category}</td>
                        <td><a href="/editEvent/${event.no}" class="link-title">${event.name}</a></td>
                        <td>${event.cast}</td>
                        <td>${event.location}</td>
                        <td><span class="status-tag">${event.age}</span></td>
                        <td style="text-align: center; cursor: pointer; color: #999;">
                            <i class="fa-solid fa-ellipsis-vertical"></i>
                        </td>
                    </tr>
                `;
                    eventListContainer.innerHTML += row;
                });
            }
        });
    </script>
</main>

</body>
</html>